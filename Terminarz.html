<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<title>Terminarz z wydarzeniami</title>
<style>
body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #e6ebed, #f5f7f9);
      margin: 0;
      padding: 0;
    }
    .header {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      background: linear-gradient(to right, #d4dce4, #f2f3f5);
    }
    .logo {
      display: flex;
      align-items: center;
      margin-right: auto;
    }
    .logo img {
      height: 40px;
      margin-right: 10px;
    }
    .logo span {
      font-size: 24px;
      color: #8a2e6e;
      font-weight: bold;
    }
    .user-info {
      margin-right: 20px;
      font-size: 14px;
    }
    .menu {
      display: flex;
      justify-content: center;
      padding: 10px;
      background-color: #edf0f3;
      flex-wrap: wrap;
    }
    .menu-item {
      text-align: center;
      margin: 10px;
      position: relative;
    }
    .menu-item a {
      font-size: 14px;
      display: block;
      padding: 10px 15px;
      background-color: #ffffff;
      border: 1px solid #ccc;
      border-radius: 10px;
      box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
      text-decoration: none;
      color: black;
      transition: background-color 0.3s;
    }
    .menu-item a:hover {
      background-color: #f0f0f0;
    }
    .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: red;
      color: white;
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 50%;
    }
  body {
    font-family: Arial, sans-serif;
    background: #f0f0f5;
    margin: 0; padding: 0;
  }
  .form {
    max-width: 900px;
    margin: 20px auto;
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
  }
  .form label {
    display: flex;
    flex-direction: column;
    font-size: 14px;
    min-width: 150px;
  }
  .form input, .form select, .form button {
    padding: 6px 8px;
    font-size: 14px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }
  .calendar {
    max-width: 900px;
    margin: 20px auto;
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
  }
  .calendar-grid {
    display: grid;
    grid-template-columns: 70px repeat(7, 1fr);
    gap: 5px;
    text-align: center;
  }
  .day.header {
    font-weight: bold;
    background: #e0e0e0;
    padding: 10px 0;
    border-radius: 6px;
  }
  .day {
    background: #fafafa;
    min-height: 100px;
    border-radius: 6px;
    position: relative;
    padding: 5px;
    overflow-y: auto;
  }
  .week-number {
    background: #ddd;
    font-weight: bold;
    padding: 10px 0;
    border-radius: 6px;
  }
  .date-number {
    position: absolute;
    top: 5px;
    right: 8px;
    font-size: 14px;
    font-weight: bold;
    color: #555;
  }
  .event {
    margin-top: 4px;
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 12px;
    color: white;
    text-align: left;
  }
  .Sprawdzian { background-color: #ff00a8; }
  .Praca-Klasowa { background-color: #ff1e1e; }
  .Projekt { background-color: #FFA500; }
  .Dzien-Wolny{ background-color: #d8ca93; }
  .Wydarzenie-Szkolne{ background-color: #d8ca93; }
  .Kartkowka { background-color: #8a2be2; }
  .Inne { background-color: #daa520; }
  .odp-ustna { background-color: #7F6A93; }
  .Nieobecnosc-nauczyciela { background-color: #ff7c7c; }
  .Zastepstwo { background-color: #709404; }
  .Odwolano { background-color: #709404; }
  .Sprawdzian-ZALICZONE { background-color: #00ff33; }
  .Praca-Klasowa-ZALICZONE { background-color: #00ff33; }
  .Kartkowka-ZALICZONE { background-color: #00ff33; }
  .Projekt-ZALICZONE { background-color: #00ff33; }
  .Inne-ZALICZONE { background-color: #00ff33; }
  .Odp-ustna-ZALICZONE { background-color: #00ff33; }
  
  .modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.5);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}
.modal-content {
  background: white;
  padding: 20px;
  border-radius: 10px;
  width: 500px;
}
.add-btn {
  position: absolute;
  bottom: 4px;
  right: 4px;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  background: #8a2e6e;
  color: white;
  font-weight: bold;
  font-size: 14px;
  box-shadow: 0 0 3px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
}
.add-btn:hover {
  background: #a73b85;
}
#date { display:none; }

</style>
</head>
<body>
<div id="eventModal" class="modal">
  <div class="modal-content">
    <h3 id="modalTitle">Dodaj wydarzenie</h3>

    <!-- TU PRZENIE≈ö CA≈ÅY FORMULARZ -->
    <!-- (bez przycisku Dodaj, tylko Zapisz) -->
<div class="form">

  <label>
    Przedmiot:
    <select id="subject">
      <option>Jƒôzyk piotrowski</option>
	  <option>Inne</option>
	  <option>-</option>
    </select>
  </label>
  <label>
    Typ wydarzenia:
    <select id="type">
      <option value="Sprawdzian">Sprawdzian</option>
      <option value="Praca-Klasowa">Praca klasowa</option>
      <option value="Projekt">Projekt</option>
      <option value="Dzien-Wolny">Dzie≈Ñ wolny</option>
	  <option value="Wydarzenie-Szkolne">Wydarzenie Szkolne</option>
      <option value="Kartkowka">Kartk√≥wka</option>
      <option value="Inne">Inne</option>
	  <option value="odp-ustna">Odp. Ustna</option>
	  <option value="Nieobecnosc-nauczyciela">Nieobecnosƒá nauczyciela</option>
	  <option value="Zastepstwo">Zastƒôpstwo</option>
	  <option value="Odwolano">Odwo≈Çano lekcje</option>
	  <option value="Sprawdzian-ZALICZONE">Sprawdzian-ZALICZONE</option>
      <option value="Praca-Klasowa-ZALICZONE">Praca klasowa - ZALICZONE</option>
      <option value="Projekt-ZALICZONE">Projekt-ZALICZONE</option>
      <option value="Kartkowka-ZALICZONE">Kartk√≥wka-ZALICZONE</option>
	  <option value="Inne-ZALICZONE">Inne-ZALICZONE</option>
	  <option value="odp-ustna-ZALICZONE">Odp. Ustna - ZALICZONE</option>
	  
    </select>
  </label>
  <label>
    Data:
    <input type="date" id="date">
  </label>
  <label>
    Komentarz:
    <input type="text" id="comment" placeholder="Opcjonalny komentarz" style="width: 180px;">
  </label>
  <label>
    Klasa:
    <select id="class">
  	  <option value="6A">6A</option>
	  <option value="6C">6C</option>
	  <option value="6H">6H</option>
      <option value="7I">7I</option>
      <option value="7L">7L</option>
      <option value="8F">8F</option>
      <option value="8J">8J</option>
      <option value="1B">1B</option>
      <option value="2E">2E</option>
	  <option value="3G">3G</option>
	  <option value="Edukacja_og√≥lna">Edukacja og√≥lna</option>
	  <option value="-">-</option>
	  <option value="Szko≈Ça">Szko≈Ça</option>
    </select>
  </label>
  <button id="submitBtn" onclick="addEvent()">Dodaj wydarzenie</button>

</div>

    <button onclick="addEvent()">Zapisz</button>
    <button onclick="closeModal()">Anuluj</button>
  </div>
</div>

    <button onclick="addEvent()">Zapisz</button>
    <button onclick="closeModal()">Anuluj</button>
  </div>
</div>


<div class="header">
  <div class="logo">
    <img src="21 maj 2025, 16_13_32.png" alt="P-Librus logo">
    <span>P-Librus</span>
  </div>
  <div class="user-info">
    Jeste≈õ zalogowany jako: <strong>Piotr Rejmentowski (nauczyciel)</strong>
  </div>
</div>

  <div class="menu">
    <div class="menu-item"><a href="indywidualni.html">Indywidualni</a></div>
    <div class="menu-item"><a href="Lekcja.html">Lekcja</a></div>
    <div class="menu-item"><a href="Oceny.html">Oceny</a></div>
    <div class="menu-item"><a href="Zachowanie.html">Zachowanie</a></div>
    <div class="menu-item"><a href="organizacja.html">Organizacja</a></div>
    <div class="menu-item"><a href="wiadomosci.html">Wiadomo≈õci</a></div>
    <div class="menu-item"><a href="ogloszenia.html">Og≈Çoszenia</a></div>
    <div class="menu-item"><a href="Terminarz.html">Terminarz</a></div>
  </div>
  <br>
  <br>
  <br>

<div style="max-width:900px;margin:0 auto 10px;display:flex;gap:10px;">
  <select id="month"></select>
  <select id="year"></select>
</div>


<div class="calendar">
  <h2 id="calendar-title"></h2>
  <div id="calendar-grid" class="calendar-grid"></div>
</div>

<script>
  const monthNames = ['Stycze≈Ñ', 'Luty', 'Marzec', 'Kwiecie≈Ñ', 'Maj', 'Czerwiec', 'Lipiec', 'Sierpie≈Ñ', 'Wrzesie≈Ñ', 'Pa≈∫dziernik', 'Listopad', 'Grudzie≈Ñ'];
  const dayNames = ['Pn', 'Wt', '≈ör', 'Cz', 'Pt', 'So', 'Nd'];

  const monthSelect = document.getElementById('month');
  const yearSelect = document.getElementById('year');
  const dateInput = document.getElementById('date');

  // Wype≈Çniamy selecty miesiƒÖc i rok
  for(let i = 0; i < 12; i++) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = monthNames[i];
    monthSelect.appendChild(opt);
  }
  for(let y = 2024; y <= 2026; y++) {
    const opt = document.createElement('option');
    opt.value = y;
    opt.textContent = y;
    yearSelect.appendChild(opt);
  }

  // Domy≈õlne warto≈õci
  const today = new Date();
  monthSelect.value = today.getMonth();
  yearSelect.value = today.getFullYear();
  dateInput.valueAsDate = today;

  monthSelect.addEventListener('change', () => generateCalendar(+monthSelect.value, +yearSelect.value));
  yearSelect.addEventListener('change', () => generateCalendar(+monthSelect.value, +yearSelect.value));

  // Funkcja numeru tygodnia wg ISO
  function getWeekNumber(date) {
  const target = new Date(date.valueOf());
  const dayNr = (date.getDay() + 6) % 7;  // Poniedzia≈Çek = 0, niedziela = 6
  target.setDate(target.getDate() - dayNr + 3);  // Ustawiamy na czwartek tego tygodnia
  const firstThursday = new Date(target.getFullYear(), 0, 4); // 4 stycznia
  const diff = target - firstThursday;
  return 1 + Math.round(diff / 604800000); // 604800000 = ms w tygodniu
}

  // Pobierz wydarzenia z localStorage
  function getEvents() {
    return JSON.parse(localStorage.getItem('events') || '[]');
  }

  // Zapisz wydarzenia do localStorage
  function saveEvents(events) {
    localStorage.setItem('events', JSON.stringify(events));
  }




  function createCell(text, isHeader = false, className = 'day') {
    const div = document.createElement('div');
    div.className = className;
    if(text !== '') div.textContent = text;
    return div;
  }
  // Generowanie kalendarza
  function generateCalendar(month, year) {
    const calendarGrid = document.getElementById('calendar-grid');
    const calendarTitle = document.getElementById('calendar-title');
    calendarTitle.textContent = `${monthNames[month]} ${year}`;
    calendarGrid.innerHTML = '';

    // Nag≈Ç√≥wki kolumn
    calendarGrid.appendChild(createCell('Tydzie≈Ñ', true, 'week-number'));
    dayNames.forEach(day => {
      calendarGrid.appendChild(createCell(day, true, 'day header'));
    });

    // Pierwszy dzie≈Ñ miesiƒÖca i jego przesuniƒôcie (poniedzia≈Çek = 0)
    const firstOfMonth = new Date(year, month, 1);
    const firstDayWeekDay = (firstOfMonth.getDay() + 6) % 7;
    const calendarStart = new Date(year, month, 1 - firstDayWeekDay);

    // Pobierz wydarzenia
    const events = getEvents();

    let current = new Date(calendarStart);

for (let week = 0; week < 6; week++) {
  const weekStart = new Date(current);

  // numer tygodnia
  calendarGrid.appendChild(
    createCell(getWeekNumber(weekStart), true, 'week-number')
  );

  for (let day = 0; day < 7; day++) {
    const currentDate = new Date(current);
    const cell = createCell('', false, 'day');

    if (currentDate.getMonth() === month) {
  const dayStr = currentDate.toLocaleDateString('sv-SE');

  cell.innerHTML = `
  <div class="date-number">${currentDate.getDate()}</div>
  <button class="add-btn" onclick="openModal('${dayStr}')">+</button>
`;


  const todaysEvents = events.filter(ev => ev.date === dayStr);

  todaysEvents.forEach(ev => {
  const globalIndex = events.indexOf(ev);
  
  const evDiv = document.createElement('div');
  evDiv.className = `event ${ev.type}`;

  evDiv.innerHTML = `
    <strong>${ev.subject}</strong><br>
    <small>${ev.type} (${ev.className})</small><br>
    ${ev.comment ? `<small>üí¨ ${ev.comment}</small><br>` : ''}
    <button class="ev-btn" onclick="editEvent(${globalIndex})">‚úè</button>
    <button class="ev-btn" onclick="deleteEvent(${globalIndex})">üóë</button>
    <button class="ev-btn" onclick="markDone(${globalIndex})">‚úî</button>
  `;
  cell.appendChild(evDiv);
});


}
 else {
      cell.style.backgroundColor = '#eee';
    }

    calendarGrid.appendChild(cell);
    current.setDate(current.getDate() + 1);
  }
}
}


let editIndex = null;

function addEvent() {
  const subject = document.getElementById('subject').value;
  const type = document.getElementById('type').value;
  const date = document.getElementById('date').value;
  const comment = document.getElementById('comment').value.trim();
  const className = document.getElementById('class').value;

  if (!date) {
    alert("Wybierz datƒô przed dodaniem wydarzenia.");
    return;
  }

  const events = getEvents();
  const eventData = {
  subject,
  type,
  date,
  comment,
  className,
  createdAt: new Date().toISOString()
};


  if (editIndex !== null) {
    events[editIndex] = eventData;
    editIndex = null;
  } else {
    events.push(eventData);
  }

  saveEvents(events);
  generateCalendar(+monthSelect.value, +yearSelect.value);
  document.getElementById('comment').value = '';
  document.getElementById('submitBtn').textContent = "Dodaj wydarzenie";
closeModal();
document.getElementById('modalTitle').textContent = "Dodaj wydarzenie";

}

function editEvent(index) {
  const events = getEvents();
  const ev = events[index];

  // wype≈Çnienie formularza
  document.getElementById('subject').value = ev.subject;
  document.getElementById('type').value = ev.type;
  document.getElementById('date').value = ev.date;
  document.getElementById('comment').value = ev.comment;
  document.getElementById('class').value = ev.className;

  editIndex = index;

  // zmiana tytu≈Çu modala
  document.getElementById('modalTitle').textContent = "Dodaj / Edytuj wydarzenie";

  // otw√≥rz modal
  openModal(ev.date);
}


function openModal(date = null) {
  document.getElementById("eventModal").style.display = "flex";
  if (date) document.getElementById("date").value = date;
}

function closeModal() {
  document.getElementById("eventModal").style.display = "none";
  editIndex = null;
}
function showEventDetails(index) {
  const ev = getEvents()[index];

  alert(`
Przedmiot: ${ev.subject}
Typ: ${ev.type}
Klasa: ${ev.className}
Data: ${ev.date}
Dodano: ${ev.createdAt ? new Date(ev.createdAt).toLocaleString() : 'brak danych'}
Komentarz: ${ev.comment || '-'}
`);
}
function deleteEvent(index) {
  const events = getEvents();
  if(confirm("UsunƒÖƒá wydarzenie?")) {
    events.splice(index, 1);
    saveEvents(events);
    generateCalendar(+monthSelect.value, +yearSelect.value);
  }
}
function markDone(index) {
  const events = getEvents();
  let ev = events[index];

  if(ev.type.includes("-ZALICZONE")) return;

  ev.type = `${ev.type}-ZALICZONE`;
  saveEvents(events);
  generateCalendar(+monthSelect.value, +yearSelect.value);
}
generateCalendar(today.getMonth(), today.getFullYear());

</script>


<br>
<br>
<br>

<footer style="text-align: center; padding: 20px; background-color: #f0f0f0;">
  <div style="margin-bottom: 10px;">
    <img src="teamppp.png" alt="Team P" style="width: 200px; margin: 0 20px;">
    <img src="21 maj 2025, 16_13_32.png" alt="p-librus" style="width: 200px; margin: 0 20px;">
    <img src="stpschool.png" alt="STP School" style="width: 200px; margin: 0 20px;">
  </div>
  <p style="font-size: 14px; color: #555;">P-Librus ¬© 2025</p>
</footer>


</body>

</html>





