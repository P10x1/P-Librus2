<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>P-Librus: Rejestr Lekcji</title>
  <style>
  body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #e6ebed, #f5f7f9);
      margin: 0;
      padding: 0;
    }
    .header {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      background: linear-gradient(to right, #d4dce4, #f2f3f5);
    }
    .logo {
      display: flex;
      align-items: center;
      margin-right: auto;
    }
    .logo img {
      height: 40px;
      margin-right: 10px;
    }
    .logo span {
      font-size: 24px;
      color: #8a2e6e;
      font-weight: bold;
    }
    .user-info {
      margin-right: 20px;
      font-size: 14px;
    }
    .menu {
      display: flex;
      justify-content: center;
      padding: 10px;
      background-color: #edf0f3;
      flex-wrap: wrap;
    }
    .menu-item {
      text-align: center;
      margin: 10px;
      position: relative;
    }
    .menu-item a {
      font-size: 14px;
      display: block;
      padding: 10px 15px;
      background-color: #ffffff;
      border: 1px solid #ccc;
      border-radius: 10px;
      box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
      text-decoration: none;
      color: black;
      transition: background-color 0.3s;
    }
    .menu-item a:hover {
      background-color: #f0f0f0;
    }
    .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: red;
      color: white;
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 50%;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #dfe9f3, #ffffff);
      padding: 40px;
      color: #333;
    }
    .lesson-box, .history-box {
      background: #ffffff;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .dzial-option {
      background-color: #000;
      color: #fff;
      font-weight: bold;
    }
    h2 {
      color: #2a6f97;
    }
    label {
      font-weight: 600;
      display: block;
      margin-top: 15px;
      color: #34495e;
    }
    select, textarea, input[type="date"], button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }
    button {
      background: #2a6f97;
      color: white;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      margin-top: 20px;
      font-weight: bold;
      transition: background 0.3s;
    }
    button:hover {
      background: #1b4965;
    }
    ul {
      padding-left: 25px;
    }
    .frekwencja-wrapper {
      margin-bottom: 15px;
      padding: 10px;
      background: #f0f8ff;
      border-radius: 8px;
    }
    .frekwencja-wrapper label {
      font-weight: 500;
      margin-bottom: 5px;
    }
    .frekwencja-wrapper span {
      margin-right: 10px;
    }
	#tabela-klas th, #tabela-klas td {
  border-bottom: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
#tabela-klas tr:hover {
  background-color: #f2f2f2;
}
.top-alert {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: #2a6f97;
  color: #ffffff;
  padding: 1em 2em;
  font-weight: bold;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.close-btn {
  background: none;
  border: none;
  font-size: 1.5em;
  line-height: 1;
  cursor: pointer;
  color: #ffffff;
}
td.pasek {
  width: 10px;
}

.pasek.dzien1 { background-color: #4CAF50; }
.pasek.dzien2 { background-color: #2196F3; }
.pasek.bio8   { background-color: #FF9800; }
.pasek.ogolna { background-color: #9C27B0; }

.modern-table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  text-align: center;
}

.modern-table th {
  background-color: #2a6f97;
  color: white;
  padding: 10px;
}

.modern-table td {
  padding: 10px;
  border-bottom: 1px solid #eee;
}

.modern-table tr:hover {
  background-color: #f0f8ff;
}

.btn-nav {
  background: #2a6f97;
  color: white;
  border: none;
  padding: 5px 10px;
  border-radius: 5px;
  cursor: pointer;
}

.btn-nav:hover {
  background: #1b4965;
}
.modern-table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  text-align: center;
}

.modern-table th {
  background-color: #2a6f97;
  color: white;
  padding: 10px;
  font-weight: 600;
}

.modern-table td {
  padding: 10px;
  border-bottom: 1px solid #eee;
  vertical-align: middle;
}

.modern-table tr:hover {
  background-color: #f0f8ff;
}

.btn-nav {
  background: #2a6f97;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
}

.btn-nav:hover {
  background: #1b4965;
}

.btn-action {
  background: #e0e0e0;
  border: none;
  padding: 5px 8px;
  border-radius: 6px;
  cursor: pointer;
  margin: 0 3px;
  transition: all 0.2s;
}

.btn-action:hover {
  background: #d4d4d4;
}

.status-label {
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 5px;
}

.status-normalna { color: #2a6f97; }
.status-odwolana { color: red; }
.status-zastepstwo { color: orange; }

.akcja-select {
  padding: 6px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  background-color: #fff;
}
.akcja-select:hover {
  background-color: #f5faff;
}
.zakonczona {
  text-decoration: line-through;
  color: #888;
  opacity: 0.6;
  cursor: not-allowed;
}
	  .tooltip {
  position: relative;
  display: inline-block;
  cursor: help;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 260px;
  background-color: #2a6f97;
  color: #fff;
  text-align: left;
  border-radius: 8px;
  padding: 10px;
  position: absolute;
  z-index: 9999;
  bottom: 125%;
  left: 0;
  opacity: 0;
  transition: opacity 0.3s;
  box-shadow: 0 3px 10px rgba(0,0,0,0.3);
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}


  </style>
</head>
<body>






<div class="header">
    <div class="logo">
      <img src="21 maj 2025, 16_13_32.png" alt="P-Librus logo">
      <span>P-Librus</span>
    </div>
    <div class="user-info">
      Zalogowany jako: <strong>Piotr Rejmentowski (nauczyciel)</strong>
    </div>

  </div>

    <div class="menu">
    <div class="menu-item"><a href="indywidualni.html">Indywidualni</a></div>
    <div class="menu-item"><a href="Lekcja.html">Lekcja</a></div>
    <div class="menu-item"><a href="Oceny.html">Oceny</a></div>
    <div class="menu-item"><a href="Zachowanie.html">Zachowanie</a></div>
    <div class="menu-item"><a href="Organizacja.html">Organizacja</a></div>
    <div class="menu-item"><a href="wiadomosci.html">Wiadomo≈õci</a></div>
    <div class="menu-item"><a href="ogloszenia.html">Og≈Çoszenia</a></div>
    <div class="menu-item"><a href="Terminarz.html">Terminarz</a></div>
	<div class="menu-item"><a href="https://zwgy5t.webwave.dev">Rejskie wydawnictwo</a></div>
  </div>
<div class="lesson-box">
  <h2>PANEL NAUCZYCIELA LEKCJI</h2>

  <div id="wybor-klasy" style="display:none;">
  <h2>Wybierz klasƒô do wpisania nowej lekcji lub edycji.</h2>
  <table style="width: 100%; border-collapse: collapse;" id="tabela-klas">
    <thead>
      <tr>
		<th><i>Kolor</th>
        <th><i>Klasa</th>
        <th><i>Ostatni temat</th>
        <th><i>Data ostatniej lekcji</th>
        <th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Ukryty select, kt√≥ry nadal u≈ºywany w kodzie -->
<select id="klasa-select" style="display: none;">
  <option value="6F-Jƒôzyk_Piotrowski">6F - Jƒôzyk Piotrowski</option>
  <option value="6H-Jƒôzyk_Piotrowski">6H - Jƒôzyk Piotrowski</option>
  <option value="7A-Jƒôzyk_Piotrowski">7A - Jƒôzyk Piotrowski</option>
  <option value="7C-Jƒôzyk_Piotrowski">7C - Jƒôzyk Piotrowski</option>
  <option value="8I-Jƒôzyk_Piotrowski">8I - Jƒôzyk Piotrowski</option>
  <option value="8L-Jƒôzyk_Piotrowski">8L - Jƒôzyk Piotrowski</option>
  <option value="1J-Jƒôzyk_Piotrowski">1J - Jƒôzyk Piotrowski</option>
  <option value="2B-Jƒôzyk_Piotrowski">2B - Jƒôzyk Piotrowski</option>
  <option value="3E-Jƒôzyk_Piotrowski">3E - Jƒôzyk Piotrowski</option>
  <option value="Edukacja_og√≥lna">Edukacja og√≥lna</option>
</select>

<!-- NOWY WIDOK PLANU LEKCJI -->
<div id="plan-lekcji" class="lesson-box">
  <h2>üìÖ Plan lekcji ‚Äì Piotr Rejmentowski</h2>

  <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
    <button id="prev-day" class="btn-nav">‚óÄ</button>
    <input type="date" id="data-plan" />
    <span id="dzien-tygodnia" style="font-weight:bold; font-size:16px; color:#2a6f97;"></span>
    <button id="next-day" class="btn-nav">‚ñ∂</button>
  </div>

  <table id="tabela-planu" class="modern-table">
    <thead>
      <tr>
        <th>Nr lekcji</th>
        <th>Klasa</th>
        <th>Temat</th>
        <th>Status</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>
<div id="plan-nieregularne" class="lesson-box" style="margin-top:25px;">
  <h3>üìò Klasy nieregularne</h3>
  <table id="tabela-nieregularne" class="modern-table">
    <thead>
      <tr>
        <th>Klasa</th>
        <th>Temat</th>
        <th>Status</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>




  <div id="lekcja-form" style="display: none;">
  <button type="button" onclick="powrotDoPlanu()">‚Üê Wr√≥ƒá do planu lekcji</button>
<script>
function powrotDoPlanu() {
  document.getElementById("lekcja-form").style.display = "none";
  document.getElementById("plan-lekcji").style.display = "block";
}
</script>

<h3 id="wybrana-klasa" style="color: #2a6f97;"></h3>



  <label for="data">Data:</label>
  <input type="date" id="data" />
  
  <br><br>
  <div class="lesson-box">
  <h2>Postƒôp realizacji materia≈Çu</h2>
  <div id="postep-box"></div>
</div>

<script>
function pokazPostep(klasa) {
  const box = document.getElementById("postep-box");
  box.innerHTML = "";

  const wszystkieTematy = tematy[klasa] || [];
  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];

  const zrealizowaneTematy = new Set(lekcje.map(l => l.temat));

  const liczbaZrealizowanych = wszystkieTematy.filter(t => zrealizowaneTematy.has(t)).length;
  const liczbaWszystkich = wszystkieTematy.length;
  const procent = liczbaWszystkich ? Math.round((liczbaZrealizowanych / liczbaWszystkich) * 100) : 0;

  box.innerHTML = `
    <p>Zrealizowano <strong>${liczbaZrealizowanych}</strong> z <strong>${liczbaWszystkich}</strong> temat√≥w (${procent}%)</p>
    <div style="background: #eee; border-radius: 10px; overflow: hidden; height: 20px;">
      <div style="width: ${procent}%; background: #2a6f97; height: 100%; color: white; text-align: center; font-size: 12px;">
        ${procent}%
      </div>
    </div>
  `;
}
function pokazPostep(klasa) {
  const box = document.getElementById("postep-box");
  box.innerHTML = "";

  const wszystkieTematy = (tematy[klasa] || []).filter(t => {
  const tLower = t.toLowerCase();
  return !t.startsWith("DZIA≈Å") &&
    (tLower.includes("powt√≥rzenie") ||
     tLower.includes("sprawdzian") ||
     tLower.includes("om√≥wienie sprawdzianu") ||
     tLower.includes("egzamin") ||
	 tLower.includes("Jak na egzaminie") ||
     (!t.startsWith("DZIA≈Å") && !tLower.includes("dzia≈Ç"))); // zwyk≈Çe bia≈Çe tematy
});

  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];

  const zrealizowaneTematy = new Set(lekcje.map(l => l.temat));
  const liczbaZrealizowanych = wszystkieTematy.filter(t => zrealizowaneTematy.has(t)).length;
  const liczbaWszystkich = wszystkieTematy.length;
  const procent = liczbaWszystkich ? Math.round((liczbaZrealizowanych / liczbaWszystkich) * 100) : 0;

  let ostatniaLekcja = lekcje.length > 0 ? lekcje[lekcje.length - 1] : null;

  box.innerHTML = `
    <p>Zrealizowano <strong>${liczbaZrealizowanych}</strong> z <strong>${liczbaWszystkich}</strong> temat√≥w (${procent}%)</p>
    <div style="background: #eee; border-radius: 10px; overflow: hidden; height: 20px; margin-bottom: 10px;">
      <div style="width: ${procent}%; background: #2a6f97; height: 100%; color: white; text-align: center; font-size: 12px;">
        ${procent}%
      </div>
    </div>
    ${
      ostatniaLekcja
        ? `
          <p><strong>Ostatni temat:</strong> ${ostatniaLekcja.temat}</p>
          <p><strong>Data lekcji:</strong> ${ostatniaLekcja.data}</p>
          ${ostatniaLekcja.opis ? `<p><strong>Komentarz:</strong> ${ostatniaLekcja.opis}</p>` : ""}
        `
        : `<p>Brak zrealizowanych temat√≥w.</p>`
    }
  `;
}

</script>
  
  <label for="temat-select">Temat lekcji:</label>
  <select id="temat-select"></select>
  
<label for="nowy-temat">Dodaj w≈Çasny temat lekcji:</label>
<input type="text" id="nowy-temat" placeholder="Wpisz nowy temat..." />
<button type="button" onclick="dodajWlasnyTemat()">Dodaj temat</button>

<label for="opis">Dodatkowe notatki:</label>
<textarea id="opis" rows="3"></textarea>

  <label>Frekwencja uczni√≥w:</label>
<button type="button" onclick="zaznaczWszystkichObecnosc()" style="margin-bottom: 10px;">Zaznacz wszystkich jako Obecno≈õƒá</button>
<div id="frekwencja-box"></div>

<label>Status lekcji:</label>
<select id="status-lekcji">
  <option value="normalna">Zajƒôcia zgodnie z planem</option>
  <option value="odwo≈Çana">Lekcja odwo≈Çana</option>
  <option value="zastepstwo">Zastƒôpstwo</option>
</select>

<div id="zastepstwo-box" style="display:none; margin-top:10px;">
  <label for="zastepca">ProwadzƒÖcy zastƒôpstwo:</label>
  <input type="text" id="zastepca" placeholder="Wpisz nazwisko zastƒôpcy..." />
</div>

  <button onclick="zapiszLekcje()">Zapisz lekcjƒô</button>
</div>

<script>
  function dodajWlasnyTemat() {
    const nowyTematInput = document.getElementById("nowy-temat");
    const nowyTemat = nowyTematInput.value.trim();

    if (nowyTemat === "") {
      alert("Proszƒô wpisaƒá temat lekcji.");
      return;
    }

    const klasa = document.getElementById("klasa-select").value;
    if (!tematy[klasa]) tematy[klasa] = [];

    tematy[klasa].push(nowyTemat);

    const tematSelect = document.getElementById("temat-select");
    const option = document.createElement("option");
    option.value = nowyTemat;
    option.textContent = nowyTemat;
    tematSelect.appendChild(option);

    tematSelect.value = nowyTemat;
    nowyTematInput.value = "";
  }

</script>
	
<div class="history-box" id="historia-box" style="display: none;">
  <h2>Historia lekcji</h2>
  <ul id="historia-lekcji"></ul>
</div>

</div> <!-- zamkniƒôcie #lekcja-form -->

<script>
  const uczniowie = {
	'8I-Jƒôzyk_Piotrowski': ['Jagoda', 'Krystian', 'Justyna'],
	'8L-Jƒôzyk_Piotrowski': ['Pawe≈Ç', 'Ola', 'Natalia', 'Karol'],
    '6F-Jƒôzyk_Piotrowski': ['Ola', 'Julia', 'Natan', 'Filip'],
	'1J-Jƒôzyk_Piotrowski': ['Zuzia', 'Kasia', 'Maja'],
    '7A-Jƒôzyk_Piotrowski': ['Agata', 'Tadeusz', 'Piotr'],
    '2B-Jƒôzyk_Piotrowski': ['Gosia', 'Grzesiek', 'Agnieszka', 'Adam'],
    '7C-Jƒôzyk_Piotrowski': ['Wiesia', 'Alina', 'Bo≈ºena', 'Halinka'],
    '3E-Jƒôzyk_Piotrowski': ['Ola', 'Maria', 'Marta'],
	'6H-Jƒôzyk_Piotrowski': ['Andrzej', 'Maciej', 'Patryk'],
	'Edukacja_og√≥lna': ['Julia','Ola','Zuzia','Tadeusz','Grzesiek','Adam','Wiesia','Bo≈ºena','Jagoda','Antek','Maciej','Tosia']
  };
  
  // Alias skr√≥conych nazw na pe≈Çne klasy
const aliasyKlas = {
  "6F": "6F-Jƒôzyk_Piotrowski",
  "6H": "6H-Jƒôzyk_Piotrowski",
  "7A": "7A-Jƒôzyk_Piotrowski",
  "7C": "7C-Jƒôzyk_Piotrowski",
  "8I": "8I-Jƒôzyk_Piotrowski",
  "8L": "8L-Jƒôzyk_Piotrowski",
  "1J": "1J-Jƒôzyk_Piotrowski",
  "2B": "2B-Jƒôzyk_Piotrowski",
  "3E": "3E-Jƒôzyk_Piotrowski"
};

function normalizujKlase(klasa) {
  return aliasyKlas[klasa] || klasa;
}


  const tematy = {
  
      "6F-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - WPROWADZENIE", "Kolory i pomieszczenia", "Alfabet i znaki piotrowskie", "DZIA≈Å 2 - Liczby i daty", "Liczby","Daty", "DZIA≈Å 3 - PIERWSZA GRAMATYKA", "Podstawy gramatyki piotrowskiej","Past simple - Wprowadzenie","Past simple - Og√≥lno≈õƒá i Upodobania","Past simple - Regularno≈õƒá i jej czas","Past simple - Osobowo≈õƒá i jej opis", "DZIA≈Å 4 - GRAMATYKA DODATKOWA", "Zaimki osobowe","Present Simple - Wprowadzenie"],
	  "6H-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - WPROWADZENIE", "Alfabet i znaki piotrowskie", "S≈Çownictwo: Kolory i pomieszczenia", "Sprawd≈∫ czy potrafisz (1)", "DZIA≈Å 2 - ≈öWIAT LICZB", "Liczby", "Daty, MiesiƒÖce", "Sprawd≈∫ czy potrafisz (2)", "DZIA≈Å 3 - GRAMATYKA", "Podstawy gramatyki piotrowskiej", "Past Simple - Jako najprostrzy czas", "Past Simple - Og√≥lno≈õƒá i upodobania", "Past Simple - Regularno≈õƒá", "Past Simple - Opis osobowy sta≈Çy", "Zaimki osobowe - Wprowadzenie", "Sprawd≈∫ czy potrafisz (3)", "DZIA≈Å 4 - NAUKA I TECHNIKA", "Nauka i technika jako pierwszy dzia≈Ç praktyczny", "UrzƒÖdzenia nowoczesnej technologii", "Nauka w szkole", "Czasowniki i osoby technologii", "Past Simple - Podsumowanie", "Sprawd≈∫ czy potrafisz (4)"],
	  "7C-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - ZDROWIE", "Czƒô≈õci cia≈Ça i zdrowy styl ≈ºycia", "Choroby, b√≥le i inne przypadki", "Past Simple - Lekcja gramatyczna", "Sprawd≈∫ czy potrafisz (1)", "DZIA≈Å 2 - ≈öWIAT I PRZYRODA", "Kontynenty oraz kraje", "Przyroda: Zwierzƒôta, Krajobrazy i ro≈õliny", "Czas poprawny, Zapis czasu s≈Çownie", "Present Simple - Lekcja gramatyczna", "Sprawd≈∫ czy potrafisz (2)", "DZIA≈Å 3 - ≈ªYCIE PRYWATNE", "Ludno≈õƒá: Rodzina i znajomi", "Czas wolny: Aktywno≈õci i dni wolne", "Present Cintus - Lekcja gramatyczna", "Sprawd≈∫ czy potrafisz (3)", "DZIA≈Å 4 - CZ≈ÅOWIEK", "Opis cz≈Çowieka: Cechy charakteru i wyglƒÖd zewnƒôtrzny", "Przedmioty: Ubi√≥r i przedmioty osobiste / u≈ºytkowe", "Etapy ≈ºycia", "Zaimki osobowe - Lekcja gramatyczna", "Por√≥wnanie czas√≥w tera≈∫niejszych - Lekcja gramatyczna", "Sprawd≈∫ czy potrafisz (4)"],
	  "7A-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - ZDROWIE","Choroby i b√≥le","Czƒô≈õci cia≈Ça i zdrowy styl ≈ºycia","Past simple","Jak na egzaminie","DZIA≈Å 2 - ≈öWIAT ORAZ PRZYRODA","Kontynenty oraz kraje","Zwierzƒôta, Krajobrazy, Ro≈õliny","Czas poprawny, Zapis czasu s≈Çownie","Present Simple","Jak na egzaminie (2)","DZIA≈Å 3 - ≈ªYCIE PRYWATNE", "Rodzina i znajomi", "Czas wolny, Wydarzenia", "Present Cintus", "Jak na egzaminie (3)","DZIA≈Å 4 - CZ≈ÅOWIEK", "Cechy charakteru, WyglƒÖd zewnƒôtrzny","Ubrania, Przedmioty osobiste", "Etapy ≈ºycia","Zaimki osobowe", "Por√≥wnanie czas√≥w tera≈∫niejszych","Jak na egzaminie (4)"],
      "8I-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - PRACA", "Zawody", "Odmiana zawod√≥w przez osoby", "Miejsca prac", "Present Simple", "Jak na egzaminie (1)", "DZIA≈Å 2 - EDUKACJA", "Przedmioty fizyczne i lekcyjne", "Pracownicy i pomieszczenia", "Czasowniki szkolne", "Present Hadsing", "Jak na egzaminie (2)", "DZIA≈Å 3 - DOM", "Rodzaje miejsc zamieszkania", "Meble wewnƒôtrzne", "Na zewnƒÖtrz", "Okre≈õlenia i pomieszczenia", "Present Past", "Jak na egzaminie (3)", "DZIA≈Å 4 - LEKCJE DODATKOWE", "Zaimki osobowe", "Gramatyka piotrowska", "Jak na egzaminie (4)"],
      "8L-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - MIEJSCE ZAMIESZKANIA", "Vocabulary (1)", "Gramar (1)", "Buking i writing (1)", "DZIA≈Å 2 - EDUKACJA", "Vocabulary (2)", "Gramar (2)", "Buking i writing (2)", "DZIA≈Å 3 - PRACA","Vocabulary (3)", "Gramar (3)", "Buking i writing (3)"],
      "1J-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - SPORT","Vocabulary (1)", "Gramar (1)", "Buking i writing (1)", "DZIA≈Å 2 - KULTURA","Vocabulary (2)", "Gramar (2)", "Buking i writing (2)", "DZIA≈Å 3 - TRANSPORT I TURYSTYKA","Vocabulary (3)", "Gramar (3)", "Buking i writing (3)"],
	  "2B-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - ≈öWIAT PRZYRODY","Vocabulary (1)", "Gramar (1)", "Buking i writing (1)", "DZIA≈Å 2 - ZDROWIE","Vocabulary (2)", "Gramar (2)", "Buking i writing (2)"],
	  "3E-Jƒôzyk_Piotrowski": ["DZIA≈Å 1 - ≈ªYWIENIE","Vocabulary (1)", "Gramar (1)", "Buking i writing (1)", "Nagra≈Ñ i lang funkq (1)", "DZIA≈Å 2 - ZAKUPY I US≈ÅUGI","Vocabulary (2)", "Gramar (2)", "Buking i writing (2)", "Nagra≈Ñ i lang funkq (2)"],
  	  "Edukacja_og√≥lna": ["DZIA≈Å - Brak temat√≥w dla tej klasy"]
 
	};

  const klasaSelect = document.getElementById("klasa-select");
  const tematSelect = document.getElementById("temat-select");

  function updateTematy() {
  tematSelect.innerHTML = "";
  const klasa = klasaSelect.value;

  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
  const zrealizowaneTematy = new Set(lekcje.map(l => l.temat));

  if (tematy[klasa]) {
    tematy[klasa].forEach(t => {
      const option = document.createElement("option");
      option.value = t;
      option.textContent = t;

      if (t.startsWith("DZIA≈Å")) {
        option.classList.add("dzial-option");
      }

      const tLower = t.toLowerCase();  
      if (
        tLower.includes("powt√≥rzenie wiadomo≈õci") ||
        tLower.includes("sprawdzian") ||
        tLower.includes("om√≥wienie sprawdzianu") ||
        tLower.includes("powt√≥rzenie do egzaminu 1") ||
        tLower.includes("powt√≥rzenie do egzaminu 2") ||
        tLower.includes("egzamin sz√≥stoklasisty") ||
        tLower.includes("jak na egzaminie") ||
		tLower.includes("praca klasowa") ||
		tLower.includes("om√≥wienie pracy klasowej") ||
        tLower.includes("inne") ||
		tLower.includes("czy potrafisz")
      ) {
        option.style.backgroundColor = "#ccffcc"; // jasnozielony
      }

      if (zrealizowaneTematy.has(t)) {
        option.style.backgroundColor = "yellow"; // temat ju≈º zrobiony
      }

      tematSelect.appendChild(option);
    });
  }

  // automatycznie zaznacz nastƒôpny temat
  wybierzNastepnyTemat(klasa, zrealizowaneTematy);
}

function wybierzNastepnyTemat(klasa, zrealizowaneTematy) {
  const lista = tematy[klasa] || [];

  for (let temat of lista) {
    if (!zrealizowaneTematy.has(temat) && !temat.startsWith("DZIA≈Å")) {
      tematSelect.value = temat;
      break;
    }
  }
}

  function pokazFrekwencje(klasa) {
    const kontener = document.getElementById("frekwencja-box");
    kontener.innerHTML = "";

    if (!uczniowie[klasa]) return;

    const wszystkieOceny = JSON.parse(localStorage.getItem("oceny") || "{}");
    const ocenyKlasy = wszystkieOceny[klasa] || [];

    uczniowie[klasa].forEach((uczen, index) => {
        const wrapper = document.createElement("div");
        wrapper.className = "frekwencja-wrapper";

        // üîµ Pobieramy oceny danego ucznia
        const ocenyUcznia = ocenyKlasy.filter(o => o.uczen === uczen);

        // üîµ Lista ocen do wy≈õwietlenia (np. 5+, 4-, 6)
        const ocenyKrotkie = ocenyUcznia.map(o => o.ocena).join(", ") || "brak";

        // üîµ Tooltip ‚Äì pe≈Çne informacje
        const tooltipHTML = ocenyUcznia.length
            ? ocenyUcznia.map(o =>
                `<div style='margin-bottom:6px'>
                    <strong>Ocena:</strong> ${o.ocena}<br>
                    <strong>Typ:</strong> ${o.typ}<br>
                    <strong>Data:</strong> ${o.data}<br>
                    <strong>Komentarz:</strong> ${o.komentarz || "‚Äî"}
                </div>`
              ).join("")
            : "Brak ocen";

        const label = document.createElement("label");
        label.innerHTML = `
            <div class="tooltip">
                <strong>${uczen}</strong> 
                <span style="color:blue">‚Äî Oceny: ${ocenyKrotkie}</span>
                <div class="tooltiptext">${tooltipHTML}</div>
            </div>
        `;
        
        wrapper.appendChild(label);

        // üîµ Frekwencja
        [
            "Obecno≈õƒá", "Sp√≥≈∫nienie", "Nieobecno≈õƒá nieusprawiedliwiona",
            "Nieobecno≈õƒá usprawiedliwiona", "Zwolnienie",
            "Rekolekcje", "Egzamin", "Sanatorium",
            "Wycieczka", "Konkurs", "Wolontariat"
        ].forEach(opcja => {
            const radio = document.createElement("input");
            radio.type = "radio";
            radio.name = `frekwencja_${index}`;
            radio.value = opcja;

            const span = document.createElement("span");
            span.textContent = opcja;

            wrapper.appendChild(radio);
            wrapper.appendChild(span);
        });

        kontener.appendChild(wrapper);
    });
}


function pokazFrekwencjeZastepstwo(klasa) {
  const kontener = document.getElementById("zastep-frekwencja");
  kontener.innerHTML = "";

  if (!uczniowie[klasa]) {
    kontener.innerHTML = "<p>Brak danych o uczniach.</p>";
    return;
  }

  uczniowie[klasa].forEach((uczen, index) => {
    const wrapper = document.createElement("div");
    wrapper.className = "frekwencja-wrapper";

    const label = document.createElement("label");
    label.textContent = uczen;
    wrapper.appendChild(label);

    [
      "Obecno≈õƒá",
      "Sp√≥≈∫nienie",
      "Nieobecno≈õƒá nieusprawiedliwiona",
      "Nieobecno≈õƒá usprawiedliwiona",
      "Zwolnienie",
      "Rekolekcje",
      "Egzamin",
      "Sanatorium",
      "Wycieczka",
      "Konkurs",
      "Wolontariat"
    ].forEach(opcja => {
      const radio = document.createElement("input");
      radio.type = "radio";
      radio.name = `zastep_frekwencja_${index}`;
      radio.value = opcja;

      const span = document.createElement("span");
      span.textContent = opcja;

      wrapper.appendChild(radio);
      wrapper.appendChild(span);
    });

    kontener.appendChild(wrapper);
  });
}
function zastepstwoZaznaczWszystkich() {
  const kontener = document.getElementById("zastep-frekwencja");
  const radios = kontener.querySelectorAll('input[type="radio"]');

  radios.forEach(radio => {
    if (radio.value === "Obecno≈õƒá") {
      radio.checked = true;
    }
  });
}

function zapiszLekcje() {
  const data = document.getElementById("data").value;
  const klasa = klasaSelect.value;
  const temat = tematSelect.value;
  const opis = document.getElementById("opis").value;
  const status = document.getElementById("status-lekcji").value;
  const zastepca = document.getElementById("zastepca")?.value || "";

  if (!data || !temat) {
    alert("Uzupe≈Çnij wszystkie dane.");
    return;
  }

  const frekwencja = [];
  if (uczniowie[klasa]) {
    uczniowie[klasa].forEach((uczen, index) => {
      const zaznaczona = document.querySelector(`input[name="frekwencja_${index}"]:checked`);
      frekwencja.push({ uczen, status: zaznaczona ? zaznaczona.value : "Brak danych" });
    });
  }

  const nowaLekcja = { data, klasa, temat, opis, status, zastepca, frekwencja };
  const klucz = `lekcje_${klasa}`;
  const istniejace = JSON.parse(localStorage.getItem(klucz)) || [];
  // üî• Szukamy, czy istnieje lekcja tego dnia
const indexIstniejacej = istniejace.findIndex(l => l.data === data);

// üî• Je≈õli istnieje ‚Üí nadpisz
if (indexIstniejacej !== -1) {
    istniejace[indexIstniejacej] = nowaLekcja;
} else {
    // üî• Je≈õli nie istnieje ‚Üí dodaj jako nowƒÖ
    istniejace.push(nowaLekcja);
}

  localStorage.setItem(klucz, JSON.stringify(istniejace));

  pokazHistorieLekcji(klasa);
  updateTematy();
  pokazFrekwencje(klasa);
  pokazPostep(klasa);
}
document.getElementById("status-lekcji").addEventListener("change", e => {
  document.getElementById("zastepstwo-box").style.display =
    e.target.value === "zastepstwo" ? "block" : "none";
});

  
 function usunLekcje(index, klasa) {
  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
  if (confirm("Czy na pewno chcesz usunƒÖƒá tƒô lekcjƒô?")) {
    lekcje.splice(index, 1);
    localStorage.setItem(klucz, JSON.stringify(lekcje));
    pokazHistorieLekcji(klasa);
    pokazPostep(klasa);
  }
}
function edytujLekcje(index, klasa) {
  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
  const lekcja = lekcje[index];

  document.getElementById("data").value = lekcja.data;
  document.getElementById("opis").value = lekcja.opis || "";
  klasaSelect.value = lekcja.klasa;
  updateTematy();
  tematSelect.value = lekcja.temat;

  pokazFrekwencje(klasa);

  if (lekcja.frekwencja) {
    lekcja.frekwencja.forEach((f, i) => {
      const radio = document.querySelectorAll(`input[name="frekwencja_${i}"]`);
      radio.forEach(r => {
        if (r.value === f.status) {
          r.checked = true;
        }
      });
    });
  }

  // Usuniƒôcie starej wersji, przed zapisaniem nowej
  lekcje.splice(index, 1);
  localStorage.setItem(klucz, JSON.stringify(lekcje));
  pokazHistorieLekcji(klasa);
  pokazPostep(klasa);
}


  function pokazHistorieLekcji(klasa) {
    const ul = document.getElementById("historia-lekcji");
    ul.innerHTML = "";
    const klucz = `lekcje_${klasa}`;
    const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];

    lekcje.forEach((lekcja, index) => {
  const li = document.createElement("li");
  li.innerHTML = `
  <strong>${lekcja.data}:</strong> ${lekcja.temat} 
  <span style="color:${lekcja.status === 'odwo≈Çana' ? 'red' : lekcja.status === 'zastepstwo' ? 'orange' : 'black'};">
    [${lekcja.status}${lekcja.zastepca ? " ‚Äì " + lekcja.zastepca : ""}]
  </span><br>${lekcja.opis || ""}
`;


  if (lekcja.frekwencja && lekcja.frekwencja.length) {
    li.innerHTML += `<br><strong>Frekwencja:</strong><ul>${
      lekcja.frekwencja.map(f => `<li>${f.uczen}: ${f.status}</li>`).join("")
    }</ul>`;
  }

  // Dodaj przyciski Edytuj i Usu≈Ñ
  const edytujBtn = document.createElement("button");
  edytujBtn.textContent = "Edytuj";
  edytujBtn.onclick = () => edytujLekcje(index, klasa);

  const usunBtn = document.createElement("button");
  usunBtn.textContent = "Usu≈Ñ";
  usunBtn.onclick = () => usunLekcje(index, klasa);

  li.appendChild(edytujBtn);
  li.appendChild(usunBtn);
  ul.appendChild(li);
});

  }

  klasaSelect.addEventListener("change", () => {
    updateTematy();
    pokazFrekwencje(klasaSelect.value);
    pokazHistorieLekcji(klasaSelect.value);
	pokazPostep(klasaSelect.value);
  });

  document.addEventListener("DOMContentLoaded", () => {
  updateTematy();
  pokazFrekwencje(klasaSelect.value);
  pokazHistorieLekcji(klasaSelect.value);
  pokazPostep(klasaSelect.value); // ‚Üê TO DODAJ
});
pokazTabeleWyboruKlasy();

  function zaznaczWszystkichObecnosc() {
  const kontener = document.getElementById("frekwencja-box");
  const radios = kontener.querySelectorAll('input[type="radio"]');

  radios.forEach(radio => {
    if (radio.value === "Obecno≈õƒá") {
      radio.checked = true;
    }
  });
}
klasaSelect.addEventListener("change", () => {
  const selected = klasaSelect.value;
  const form = document.getElementById("lekcja-form");

  if (selected) {
    form.style.display = "block";
    updateTematy();
    pokazFrekwencje(selected);
    pokazHistorieLekcji(selected);
    pokazPostep(selected);
  } else {
    form.style.display = "none";
  }
});
function pokazTabeleWyboruKlasy() {
  const tabela = document.querySelector("#tabela-klas tbody");
  tabela.innerHTML = "";

  Object.keys(tematy).forEach(klasa => {
    const klucz = `lekcje_${klasa}`;
    const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
    const ostatnia = lekcje.length ? lekcje[lekcje.length - 1] : null;

    const tr = document.createElement("tr");

    // nazwa klasy (dla 2H-Jƒôzyk_Piotrowski przekre≈õlona)
    const nazwaKlasy = klasa === "2H-Jƒôzyk_Piotrowski"
      ? `<span style="text-decoration: line-through;">${klasa}</span>`
      : klasa;

    tr.innerHTML = `
      <td style="background-color:${kolory[klasa] || 'transparent'}; width: 10px;"></td>
      <td>${nazwaKlasy}</td>
      <td>${ostatnia ? ostatnia.temat : '<em>‚Äì</em>'}</td>
      <td>${ostatnia ? ostatnia.data : '<em>‚Äì</em>'}</td>
      <td>
        <button onclick="wybierzKlase('${klasa}')">Wybierz i sprawd≈∫ obecno≈õƒá</button>
      </td>
    `;

    tabela.appendChild(tr);
  });
}



function wybierzKlase(klasa) {
  document.getElementById("klasa-select").value = klasa;
  document.getElementById("lekcja-form").style.display = "block";
  document.getElementById("wybor-klasy").style.display = "none";
  document.getElementById("historia-box").style.display = "block";

  // ‚ú® Dodaj ten wiersz:
  document.getElementById("wybrana-klasa").textContent = "Wybrana klasa: " + klasa;

  updateTematy();
  pokazFrekwencje(klasa);
  pokazHistorieLekcji(klasa);
  pokazPostep(klasa);
}

// üü¶ Wype≈Çnij listƒô klas
document.addEventListener("DOMContentLoaded", () => {
  const select = document.getElementById("zast-klasa");
  Object.keys(tematy).forEach(kl => {
    const op = document.createElement("option");
    op.value = kl;
    op.textContent = kl;
    select.appendChild(op);
  });
});


// üüß Zapisanie zastƒôpstwa do localStorage
function addZastepstwo() {
  const data = document.getElementById("zast-data").value;
  const klasa = document.getElementById("zast-klasa").value;
  const przedmiot = document.getElementById("zast-przedmiot").value.trim();
  const nieobecny = document.getElementById("zast-nieobecny").value.trim();
  const prowadzacy = document.getElementById("zast-prowadzacy").value.trim();
  const frekwencja = [];

if (uczniowie[klasa]) {
  uczniowie[klasa].forEach((uczen, index) => {
    const zaznaczone = document.querySelector(`input[name="zastep_frekwencja_${index}"]:checked`);
    frekwencja.push({
      uczen,
      status: zaznaczone ? zaznaczone.value : "Brak danych"
    });
  });
}
document.getElementById("zast-klasa").addEventListener("change", () => {
  let klasaOryginal = document.getElementById("zast-klasa").value;

  // u≈ºywamy aliasu tylko do wczytania uczni√≥w
  let klasaDoFrekwencji = normalizujKlase(klasaOryginal);

  pokazFrekwencjeZastepstwo(klasaDoFrekwencji);
});


  if (!data || !klasa || !przedmiot || !prowadzacy) {
    alert("Uzupe≈Çnij wszystkie pola!");
    return;
  }

  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];

  lekcje.push({
    data,
    klasa,
    temat: `Zastƒôpstwo z przedmiotu: ${przedmiot}`,
    status: "zastepstwo",
    zastepca: prowadzacy,
    nieobecny
  });

  localStorage.setItem(klucz, JSON.stringify(lekcje));

  alert("‚úì Zastƒôpstwo dodane!");
  
  // od≈õwie≈º plan dnia
  pokazPlan(new Date(data));
}

// AUTOMATYCZNIE dodaj klasƒô do planu na ten dzie≈Ñ
const dni = ["niedziela","poniedzia≈Çek","wtorek","≈õroda","czwartek","piƒÖtek","sobota"];
const dzienTyg = dni[new Date(data).getDay()];

if (!planLekcji[dzienTyg]) planLekcji[dzienTyg] = [];

if (!planLekcji[dzienTyg].some(p => p.klasa === klasa)) {
  planLekcji[dzienTyg].push({
    nr: planLekcji[dzienTyg].length + 1, // numer lekcji kolejny
    klasa: klasa
  });
}
document.getElementById("zast-klasa").addEventListener("change", () => {
  const klasa = document.getElementById("zast-klasa").value;
});

document.getElementById("zast-klasa").addEventListener("change", () => {
  let klasa = document.getElementById("zast-klasa").value;

  if (typeof normalizujKlase === "function") {
    klasa = normalizujKlase(klasa); 
  }

  pokazFrekwencjeZastepstwo(klasa);
});

</script>

<div class="lesson-box">
  <h2>‚ûï Dodaj w≈Çasne zastƒôpstwo</h2>

  <label>Data zastƒôpstwa:</label>
  <input type="date" id="zast-data" />

  <label>Klasa:</label>
  <select id="zast-klasa">
    <option value="">‚Äî wybierz ‚Äî</option>
	<option value="6H">6H</option>
	<option value="6F">6F</option>
	<option value="7A">7A</option>
	<option value="7C">7C</option>
	<option value="8I">8I</option>
	<option value="8L">8L</option>
	<option value="1J">1J</option>
	<option value="2B">2B</option>
	<option value="3E">3E</option>
  </select>


  <label>Przedmiot:</label>
<select id="zast-przedmiot">
  <option value="">‚Äî wybierz przedmiot ‚Äî</option>
  <option>Biologia</option>
  <option>Chemia</option>
  <option>Matematyka</option>
  <option>Jƒôzyk polski</option>
  <option>Jƒôzyk angielski</option>
  <option>Geografia</option>
  <option>Historia</option>
  <option>Wychowanie fizyczne</option>
  <option>Muzyka</option>
  <option>Plastyka</option>
  <option>Informatyka</option>
  <option>Fizyka</option>
  <option>Religia</option>
  <option>Edukacja zdrowotna</option>
  <option>Zastƒôpstwo og√≥lne</option>
</select>

<label>Inny przedmiot (opcjonalnie):</label>
<input type="text" id="zast-przedmiot-inny" placeholder="Wpisz, je≈õli nie ma na li≈õcie" />


  <label>Nauczyciel nieobecny:</label>
  <input type="text" id="zast-nieobecny" placeholder="Np. Kowalski" />

  <label>ProwadzƒÖcy zastƒôpstwo:</label>
  <input type="text" id="zast-prowadzacy" value="Piotr Rejmentowski" />



<div id="zastep-frekwencja"></div>

  <button onclick="addZastepstwo()">Dodaj zastƒôpstwo</button>
</div>



<footer style="text-align: center; padding: 20px; background-color: #f0f0f0;">
  <div style="margin-bottom: 10px;">
    <img src="teamppp.png" alt="Team P" style="width: 200px; margin: 0 20px;">
    <img src="21 maj 2025, 16_13_32.png" alt="p-librus" style="width: 200px; margin: 0 20px;">
    <img src="stpschool.png" alt="STP School" style="width: 200px; margin: 0 20px;">
  </div>
  <p style="font-size: 14px; color: #555;">P-Librus ¬© 2025</p>
</footer>

<script type="module">
  import { db } from "./firebase.js";
  import { collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

  // üü¢ Funkcja: zapisz lekcjƒô w chmurze
  async function zapiszLekcje() {
    const klasa = document.getElementById("klasa").value;
    const temat = document.getElementById("temat").value;
    const data = document.getElementById("data").value;

    await addDoc(collection(db, "lekcje"), {
      klasa,
      temat,
      data,
      createdAt: new Date()
    });

    alert("‚úÖ Lekcja zapisana w chmurze!");
  }

  // üü£ Funkcja: pobierz lekcje i wypisz w konsoli
  async function pobierzLekcje() {
    const querySnapshot = await getDocs(collection(db, "lekcje"));
    querySnapshot.forEach((doc) => {
      console.log(doc.id, " => ", doc.data());
    });
  }

  // üß† Po za≈Çadowaniu strony ‚Äî pobierz lekcje
  window.addEventListener("DOMContentLoaded", pobierzLekcje);

  // üñ±Ô∏è Przyk≈Çad: po klikniƒôciu przycisku "Zapisz"
  document.getElementById("zapisz").addEventListener("click", zapiszLekcje);
</script>

<script>
const planLekcji = {
  "poniedzia≈Çek": [
    { nr: 1, klasa: "6H-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "6F-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "1J-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "2B-Jƒôzyk_Piotrowski" },
	{ nr: 5, klasa: "3E-Jƒôzyk_Piotrowski" },
  ],
  "wtorek": [
    { nr: 1, klasa: "7A-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "7C-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "8I-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "8L-Jƒôzyk_Piotrowski" },
  ],
  "≈õroda": [
    { nr: 1, klasa: "6H-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "6F-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "1J-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "2B-Jƒôzyk_Piotrowski" },
	{ nr: 5, klasa: "3E-Jƒôzyk_Piotrowski" },
  ],
  "czwartek": [
    { nr: 1, klasa: "7A-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "7C-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "8I-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "8L-Jƒôzyk_Piotrowski" },
  ],
  "piƒÖtek": [
    { nr: 1, klasa: "6H-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "6F-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "1J-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "2B-Jƒôzyk_Piotrowski" },
	{ nr: 5, klasa: "3E-Jƒôzyk_Piotrowski" },
  ],
    "sobota": [
    { nr: 1, klasa: "7A-Jƒôzyk_Piotrowski" },
    { nr: 2, klasa: "7C-Jƒôzyk_Piotrowski" },
    { nr: 3, klasa: "8I-Jƒôzyk_Piotrowski" },
    { nr: 4, klasa: "8L-Jƒôzyk_Piotrowski" },
  ]
};
// üî∏ Klasy, kt√≥re zako≈Ñczy≈Çy materia≈Ç
const zakonczoneKlasy = [

];

// üî∏ Klasy nieregularne (pojawiajƒÖ siƒô tylko w okre≈õlone dni)
const nieregularneKlasy = {
  "poniedzia≈Çek": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ],
  "wtorek": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ],
  "≈õroda": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ],
  "czwartek": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ],
  "piƒÖtek": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ],
  "sobota": [
    { nr: 1, klasa: "Edukacja_og√≥lna" },
  ]
  };

function pokazPlan(date) {
  const tabela = document.getElementById("tabela-planu").querySelector("tbody");
  tabela.innerHTML = "";

  const dni = ["niedziela","poniedzia≈Çek","wtorek","≈õroda","czwartek","piƒÖtek","sobota"];
  const dzien = dni[date.getDay()];
  const dzienData = date.toISOString().split("T")[0];

  document.getElementById("dzien-tygodnia").textContent = dzien.charAt(0).toUpperCase() + dzien.slice(1);
  document.getElementById("data-plan").value = dzienData;

  // üü¶ STA≈ÅY PLAN DNIA
  const planDnia = planLekcji[dzien] || [];

  // üü® ZASTƒòPSTWA i dodatkowe lekcje z localStorage
  const dynamiczneWpisy = [];

  Object.keys(localStorage).forEach(key => {
    if (key.startsWith("lekcje_")) {
      const lekcje = JSON.parse(localStorage.getItem(key)) || [];
      lekcje
        .filter(l => l.data === dzienData)
        .forEach(l => dynamiczneWpisy.push(l));
    }
  });

  // üü© WY≈öWIETLENIE:  najpierw sta≈Çy plan, potem dynamiczne wpisy
  let numer = 1;

  // --- STA≈ÅE LEKCJE ---
  planDnia.forEach(poz => {
    const klasa = poz.klasa;

    const wpisana = dynamiczneWpisy.filter(l => l.klasa === klasa).pop();

    const temat = wpisana
      ? (wpisana.status === "zastepstwo" ? "Zastƒôpstwo: " + (wpisana.temat || "") : wpisana.temat)
      : "‚Äî";

    const status = wpisana ? wpisana.status : "normalna";

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${poz.nr}</td>
      <td>${klasa}</td>
      <td>${temat}</td>
      <td><span class="status-label status-${status}">${status}</span></td>
      <td>
        <select class="akcja-select" onchange="wykonajAkcje(this.value, '${klasa}', '${dzienData}')">
          <option value="">‚Äî wybierz ‚Äî</option>
          <option value="otworz">Wpisz lekcjƒô / obecno≈õƒá</option>
          <option value="odwolaj">Odwo≈Çaj lekcjƒô</option>
          <option value="zastepstwo">Zastƒôpstwo</option>
        </select>
      </td>
    `;
    tabela.appendChild(tr);
  });

  // --- DYNAMICZNIE DODANE LEKCJE (NOWE, ZASTƒòPSTWA, NIE W PLANIE) ---
  dynamiczneWpisy
    .filter(l => !planDnia.some(p => p.klasa === l.klasa))
    .forEach(l => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${numer++}</td>
        <td>${l.klasa}</td>
        <td>${l.temat}</td>
        <td><span class="status-label status-${l.status}">${l.status}</span></td>
        <td>
          <select class="akcja-select" onchange="wykonajAkcje(this.value, '${l.klasa}', '${dzienData}')">
            <option value="">‚Äî wybierz ‚Äî</option>
            <option value="otworz">Edytuj lekcjƒô</option>
            <option value="odwolaj">Odwo≈Çaj</option>
            <option value="zastepstwo">Zastƒôpstwo</option>
          </select>
        </td>
      `;
      tabela.appendChild(tr);
    });
}

function wykonajAkcje(akcja, klasa, data) {
  if (akcja === "otworz") {
    otworzLekcje(klasa, data);
  } else if (akcja === "odwolaj") {
    odwolajLekcje(klasa, data);
  } else if (akcja === "zastepstwo") {
    zastepstwoLekcji(klasa, data);
  }
}

function otworzLekcje(klasa, data) {
  document.getElementById("plan-lekcji").style.display = "none";
  document.getElementById("lekcja-form").style.display = "block";
  document.getElementById("historia-box").style.display = "block";
  document.getElementById("klasa-select").value = klasa;
  document.getElementById("data").value = data;
  document.getElementById("wybrana-klasa").textContent = "Wybrana klasa: " + klasa;
  updateTematy();
  pokazFrekwencje(klasa);
  pokazHistorieLekcji(klasa);
  pokazPostep(klasa);
}

function odwolajLekcje(klasa, data) {
  if (!confirm(`Czy na pewno chcesz odwo≈Çaƒá lekcjƒô z klasy ${klasa} (${data})?`)) return;
  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
  lekcje.push({ data, klasa, temat: "‚Äî", status: "odwolana" });
  localStorage.setItem(klucz, JSON.stringify(lekcje));
  pokazPlan(new Date(data));
}

function zastepstwoLekcji(klasa, data) {
  const zastepca = prompt("Podaj nazwisko nauczyciela prowadzƒÖcego zastƒôpstwo:");
  if (!zastepca) return;
  const klucz = `lekcje_${klasa}`;
  const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
  function zastepstwoLekcji(klasa, data) {
    const zastepca = prompt("Podaj nazwisko nauczyciela prowadzƒÖcego zastƒôpstwo:");
    if (!zastepca) return;

    const klucz = `lekcje_${klasa}`;
    const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];

    lekcje.push({ data, klasa, temat: "Zastƒôpstwo", status: "zastepstwo", zastepca });

    localStorage.setItem(klucz, JSON.stringify(lekcje));
    alert("Zastƒôpstwo zapisane.");
}

  lekcje.push({ data, klasa, temat: "Zastƒôpstwo", status: "zastepstwo", zastepca });
  localStorage.setItem(klucz, JSON.stringify(lekcje));
  pokazPlan(new Date(data));
}
function pokazKlasyNieregularne() {
  const tabela = document.getElementById("tabela-nieregularne").querySelector("tbody");
  tabela.innerHTML = "";

  // üîπ znajd≈∫ wszystkie klasy, kt√≥re nie wystƒôpujƒÖ w planLekcji
  const klasyWPlanie = Object.values(planLekcji).flat().map(p => p.klasa);
  const wszystkieKlasy = Object.keys(uczniowie || {});
  const nieregularne = wszystkieKlasy.filter(k => !klasyWPlanie.includes(k));

  nieregularne.forEach(klasa => {
    const klucz = `lekcje_${klasa}`;
    const lekcje = JSON.parse(localStorage.getItem(klucz)) || [];
    const ostatnia = lekcje[lekcje.length - 1];
    const tematInfo = ostatnia ? `‚úÖ ${ostatnia.temat} (${ostatnia.data})` : "‚Äî";
    const status = ostatnia ? (ostatnia.status || "normalna") : "normalna";
    const zakonczona = zakonczoneKlasy.includes(klasa);

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="${zakonczona ? 'zakonczona' : ''}" title="${zakonczona ? 'Zako≈Ñczyli materia≈Ç' : ''}">${klasa}</td>
      <td>${tematInfo}</td>
      <td><span class="status-label status-${status}">${status}</span></td>
      <td>
        <select class="akcja-select" ${zakonczona ? 'disabled' : ''} onchange="wykonajAkcje(this.value, '${klasa}', new Date().toISOString().split('T')[0])">
          <option value="">‚Äî wybierz ‚Äî</option>
          <option value="otworz">Wybierz i sprawd≈∫ obecno≈õƒá</option>
          <option value="odwolaj">Odwo≈Çaj lekcjƒô</option>
          <option value="zastepstwo">Zastƒôpstwo</option>
        </select>
      </td>
    `;
    tabela.appendChild(tr);
  });
}

let currentDate = new Date();

pokazPlan(currentDate);
pokazKlasyNieregularne();


document.getElementById("prev-day").addEventListener("click", () => {
  currentDate.setDate(currentDate.getDate() - 1);
  pokazPlan(currentDate);
});
document.getElementById("next-day").addEventListener("click", () => {
  currentDate.setDate(currentDate.getDate() + 1);
  pokazPlan(currentDate);
});
document.getElementById("data-plan").addEventListener("change", e => {
  currentDate = new Date(e.target.value);
  pokazPlan(currentDate);
});
</script>

	
</body>
</html>







